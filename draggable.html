<!DOCTYPE html>
<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.7.28">
  <title>Draggable Windows</title>
<!--
// Copyright (C) 2020 by Henry Kroll, thenerdshow.com
/* Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License. */ //-->
<!-- uncomment for syntax highlighting with highlight.js
  <link rel="stylesheet" href="css/github.css">
  <script src="js/highlight.pack.js"></script>
  <script>
  hljs.initHighlightingOnLoad();
  </script>//-->
  <style>
  /* a container class to handle drag events */
  .draggable {
     position: absolute;
     right: 10px;
  }
  /* a titlebar class to move a parent around with it */
  .titlebar {
     cursor: move;
     padding: 10px;
     background-color: #2196F3;
     color: #fff;
     font-weight: bold;
  }
  /* a drag class to move elements without a titlebar */
  .drag {
      cursor: move;
  }
  </style>
  <style>
  .white {
     background-color: #f1f1f1;
     text-align: center;
     border: 1px solid #888;
     position: relative;
  }
  .white:hover {
     box-shadow: 5px 10px 8px #222;
  }
  code {
     margin: auto;
     float: left;
     border: 1px solid black;
  }
  body{
     background: #846942;
  }
  </style>
</head>
<body>
  <h1>Draggable Windows</h1>
  
  <p>This tutorial walks through creating a page
  with dragable windows and other mobile elements.</p>
  
  <p>Although there are other drag and move scripts out there, this
  one is easy to use, versatile, well-organized, and compact. It
  works with mice, touch screens, and tablets. It supports multiple
  elements or div windows on a page. Elements may be configured
  via CSS to be enabled for moving/dragging around either
  via a title bar, or by clicking on the body of the element.
  That's important because some objects contain interactive
  elements that dragging might interfere with. We also added events
  to the elements so we can trigger things, such as drop shadows
  appearing under them while they move.</p>
  
  <p>This script is part of our Kickass javascript framework.
  We are releasing the framework as separate, modular,
  components like this one. Use only what is necessary for
  faster page loads, simplicity, and convenience.
  Download updated modules from <a href="https://github.com/themanyone/kickass">GitHub</a>.</p>
  
  <div class="draggable">
     
    <div id="mydiv" class="white">
      <div class="titlebar">
        Drag this title bar.
      </div>
      <p>This div is only</p>
      <p>dragable via</p>
      <p>the title bar.</p>
    </div>
    
    <div class="white drag">
      <p>Drag this separately.</p>
    </div>
    
    <div style="border-radius: 50%" class="white drag">
       <p>Oval</p>
    </div>
    
  </div>
  <h2>CSS Classes</h2>
  
  <p>First let's define some CSS classes to identify which elements
  can move. We define three classes, a <b>draggable</b> class, a
  <b>titlebar</b> class, and a separate <b>drag</b>
  class. For clarity, we do not include browser-specific CSS prefixes.
  Go ahead and add the ones you need, or use
  <a href="http://leaverou.github.io/prefixfree/">-prefix-free</a> with <a href="http://leaverou.github.io/prefixfree/#plugins">dynamic DOM</a> plugin to make our scripts work across all current browsers.</p>
  
  <script id="dragElements">
  /* Draggable Elements: Drag and dragElements elements with mouse or gestures
     Improvements over the original include titlebars, zIndex, events */

     //Originally from:
     //www.kirupa.com/html5/drag.htm
     //www.kirupa.com/html5/examples/drag_multiple.htm

  function dragElements(e){
    var container = document.querySelector(e);
    var activeItem = null, ca = container.addEventListener;
    
    ca("touchstart", dragStart, false);
    ca("touchend", dragEnd, false);
    ca("touchmove", drag, false);

    ca("mousedown", dragStart, false);
    ca("mouseup", dragEnd, false);
    ca("mousemove", drag, false);
    
    //create some events
    var startmove = new CustomEvent('startmove');
    var moving = new CustomEvent('moving');
    var stopmove = new CustomEvent('stopmove');

    function dragStart(e) {
      var et = e.target;
      //activeItem is either a parent of a titlebar, or drag
      if (et.classList.contains("titlebar")){ et = et.parentElement; }
      else {//find something to drag
         while (!et.classList.contains("drag")){
            //if nothing is drag, we're done here
            if (!et.parentElement || et === container) return;
            et = et.parentElement; //keep looking
         }
      } activeItem = et;
      
      //move on top of other elements
      for (i = container.children.length; i--;)
         container.children[i].style.zIndex="";
      activeItem.style.zIndex="1";

       if (!activeItem.xOffset) { activeItem.xOffset = 0; }
       if (!activeItem.yOffset) { activeItem.yOffset = 0; }
      
       if (e.type === "touchstart") {
         activeItem.initialX = e.touches[0].clientX - activeItem.xOffset;
         activeItem.initialY = e.touches[0].clientY - activeItem.yOffset;
       } else {
         //console.log("Dragging", e.etet.tagName);
         activeItem.initialX = e.clientX - activeItem.xOffset;
         activeItem.initialY = e.clientY - activeItem.yOffset;
       }
        activeItem.dispatchEvent(startmove);
    }

    function dragEnd(e) {
      if (activeItem) {
        activeItem.initialX = activeItem.currentX;
        activeItem.initialY = activeItem.currentY;
        activeItem.dispatchEvent(stopmove);
      }
      activeItem = null;
    }

    function drag(e) {
      if (activeItem) {
        if (e.type === "touchmove") {
          e.preventDefault();
          activeItem.currentX = e.touches[0].clientX - activeItem.initialX;
          activeItem.currentY = e.touches[0].clientY - activeItem.initialY;
        } else {
          activeItem.currentX = e.clientX - activeItem.initialX;
          activeItem.currentY = e.clientY - activeItem.initialY;
        }
        activeItem.xOffset = activeItem.currentX;
        activeItem.yOffset = activeItem.currentY;
        setTranslate(activeItem.currentX, activeItem.currentY, activeItem);
        activeItem.dispatchEvent(moving);
      }
    }

    function setTranslate(xPos, yPos, el) {
      el.style.transform = "translate(" + xPos + "px, " + yPos + "px)";
    }
  }
  window.addEventListener('load', dragElements(".draggable"));
  </script> 
  <script>

  function htmlEntities(str) {
    return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
  }
  document.write("<pre><code>&lt;html&gt;&lt;head&gt;\n&lt;style&gt;",
   htmlEntities(document.querySelector("style").innerText), "\n&lt;/style&gt;&lt;/head&gt;&lt;body&gt;</code></pre>");
  </script><noscript>View the page source to see how to create the
  CSS styles.</noscript>
  
  <h2 style="clear:both">Draggable Elements</h2>
  <p>
  Create an element such as a <b>div</b> and assign a
  <b>class="draggable"</b> to it. This serves as
  a container to receive drag and move events. Place all draggable
  elements inside it. They do not have to stay inside it (They can use
  absolute positioning). Here, we define two dragable elements. One of
  them can be draggable via a <b>titlebar</b>. The other one below it
  does not need a titlebar because it has a <b>drag</b> class.</p>
  
  <script>
   var t = htmlEntities(document.querySelector("div.draggable").outerHTML);
   document.write("<pre><code class=html>  ",
   t, "\n</code></pre>");
  </script>
  <h2 style="clear:both">JavaScript</h2>
  <p>
  Here is the javascript to move things around.</p>
  <script>
   document.write("<pre><code>&lt;script&gt;",
   htmlEntities(document.querySelector("script#dragElements").innerText), "\n&lt;/script&gt;</code></pre>");
  </script>
  <p style="clear:both"><br>
  We don't have to paste the code onto a page below other elements
  like this. We could have loaded <b>dragElements.js</b> from a
  <b>&lt;script&gt;</b> tag:<br>&lt;script 
  src="js/dragElements.js"&gt;&lt;/script&gt;</p>
  
 
  <h2>Custom events.</h2>
  
  <p>The above script adds three custom events,
  <b>startmove</b>, <b>moving</b>, and <b>stopmove</b>. Let's add
  listeners to these events so that when we move them they look
  orange. We could do other things such as get their positions
  when they are set down for something like a chess game.</p>
  
  <script id="shadows">
   var divs = document.querySelectorAll(".white");
   divs[0].addEventListener("startmove",
      e=>e.target.style.background="orange");
   divs[1].addEventListener("startmove",
      e=>e.target.style.background="orange");
   var divs = document.querySelectorAll(".white");
   divs[0].addEventListener("stopmove",
      e=>e.target.style.background="white");
   divs[1].addEventListener("stopmove",
      e=>e.target.style.background="white");
  </script> 
  <script>

   document.write("<pre><code>&lt;script&gt;\n",
   htmlEntities(document.querySelector("script#shadows").innerText), "\n&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code></pre>");
  </script>
  <h2 style="clear:both">Wrapping Up</h2>
  <p>
  Well, that's it. We defined CSS classes for dragable objects, one
  that moves with a titlebar, and one that doesn't. We created
  a page to display them. We defined elements that can move with the
  mouse or with tablet and phone gestures. Then we added events to
  the dragable elements to color them as they move.
  If this tutorial was helpful, please subcribe for more updates.</p>
</body>
</html>
